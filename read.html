<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Note Taking App</title>
    <link rel="shortcut icon" href="tab-icon.svg" type="image/x-icon" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://kit.fontawesome.com/055e77e62f.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body class="bg-gray-100 font-sans text-gray-800">
    <header class="bg-white shadow p-4 flex items-center space-x-2">
      <i class="fa-regular fa-file text-blue-500"></i>
      <p class="font-semibold">Note Taking App</p>
    </header>

    <main class="max-w-2xl mx-auto mt-10">
      <a href="index.html" class="inline-block text-blue-500 hover:text-blue-700 mb-4">
        <i class="fa-solid fa-arrow-left"></i> Back to Notes
      </a>
      <div id="read-container" class="p-8 bg-white rounded-lg shadow-md">
        <!--content goes here-->
      </div>
      <div class="flex space-x-4 mt-6">
        <button id="del-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-colors duration-200">Delete</button>
        <button id="edit-btn" class="bg-gray-500 cursor-not-allowed text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" disabled>Edit (Coming Soon)</button>
      </div>
    </main>

    <script>
      function escapeHTML(str) {
        const p = document.createElement("p");
        p.textContent = str;
        return p.innerHTML;
      }

      const urlParams = new URLSearchParams(window.location.search);
      const noteId = urlParams.get("id");

      let notes = JSON.parse(localStorage.getItem("notes")) || [];

      const currentNote = notes.find((note) => {
        return note.id == Number(noteId);
      });

      const container = document.getElementById("read-container");

      if (currentNote) {
        const cleanTitle = escapeHTML(currentNote.title);
        const cleanContent = escapeHTML(currentNote.content);

        const noteHTML = `
            <h2 class="text-3xl font-bold text-gray-800 mb-4">${cleanTitle}</h2>
            <p class="text-gray-700 leading-relaxed text-lg">${cleanContent}</p>
        `;

        container.innerHTML = noteHTML;
      } else {
        container.innerHTML = `<p class="text-center text-gray-500">Note not found.</p>`;
      }

      // delete button functionality
      const deleteButton = document.getElementById("del-btn");

      deleteButton.addEventListener("click", function (e) {
        e.preventDefault();

        if (confirm('Are you sure you want to delete this note?')) {
            const updatedNotes = notes.filter((note) => note.id != Number(noteId));

            localStorage.setItem("notes", JSON.stringify(updatedNotes));
            alert("Note deleted");

            window.location.href = "index.html";
        }
      });
    </script>
  </body>
</html>
